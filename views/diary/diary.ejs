<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="/stylesheets/diary.css">
</head>
<body>
    <%- include('../header.ejs') -%>
    <%- include('../menu.ejs') -%>
    <div class="diaryContainer">
        <main>
            <section class="diary-entry">
                <div class="photo">
                    <div class="photo-frame">
                        <img class="photo-of-the-day" src="image_placeholder.jpg">
                    </div>
                    <button class="photo-button" onclick="addPhoto()">+</button>
                </div>
                <div class="entry">
                    <div class="entry-inputs">
                        <div class="input-group">
                            <label for="date">
                            <input type="date" id="date" name="date" onchange="loadDiaryEntry()">
                        </div>
                        <div class="input-group">
                            <label for="weather">
                            <input type="text" id="weather" name="weather" placeholder="오늘의 날씨">
                        </div>
                    </div>
                    <textarea id="diary-text" placeholder="오늘 하루는 어땠나요?"></textarea>
                    <div class="buttons">
                        <button class="save-button">저장하기</button>
                    </div>
                </div>
            </section>
        </main>
    </div>
    <!-- <script src="scripts.js"></script> -->
    <script>
        function getTodayDate() {
            const today = new Date();
            const year = today.getFullYear();
            const month = String(today.getMonth() + 1).padStart(2, '0');
            const day = String(today.getDate()).padStart(2, '0');
            return `${year}-${month}-${day}`;
        }

        document.addEventListener('DOMContentLoaded', () => {
            const dateInput = document.getElementById('date');
            dateInput.max = getTodayDate();
        });

        function loadDiaryEntry() {
            const date = document.getElementById('date').value;
            if (date) {
                fetch(`/diary/${date}`)
                    .then(response => response.json())
                    .then(data => {
                        if (data) {
                            document.getElementById('weather').value = data.weather;
                            document.getElementById('diary-text').value = data.text;
                        } else {
                            document.getElementById('weather').value = '';
                            document.getElementById('diary-text').value = '';
                        }
                    })
                    .catch(error => console.error('Error fetching diary entry:', error));
            }
        }
    </script>
</body>
</html>
